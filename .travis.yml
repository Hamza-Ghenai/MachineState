os: linux
dist: xenial
arch:
  - amd64
  - ppc64le
  - arm64
language: python
python:
- '3.4'
- '3.5'
- '3.6'
- '3.7'
env:
- CC=testcompiler CXX=testccompiler FC=testfortran
before_install:
- pip install codecov
- pip install requests
- sudo apt-get install openmpi-bin slurm slurm-client
install:
- pip install -e .
script:
- coverage run -p tests/all_tests.py
- coverage run -p `which machinestate` -e -s -i 4 -o output-ext.json
- coverage run -p `which machinestate` -s -i 4 -o output.json
- coverage run -p `which machinestate` -c
- coverage run -p `which machinestate` -e -s -a hostname
- coverage run -p `which machinestate` -j output.json
- coverage run -p `which machinestate` -j -e output.json
- coverage run -p `which machinestate` -j output-ext.json
after_success:
- coverage combine
- codecov
cache: pip
